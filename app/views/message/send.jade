.loading_div(ng-show = 'loading')
.dl_message_box(ng-show = '!loading')
  .dl_row
    form.comment_form.dl_message_send_area(name="message_form" novalidate)
      .dl_message_send.dl_vertical
        span.subtitle(ng-if="teamName != 'null'")
          发往 {{teamName}}:
        span(ng-if="teamName == 'null'")
          select.company_message_select(tabindex="2" ng-model="company_send_select" ng-options="s.value for s in company_send_selects" ng-change="getMessageSendType(company_send_select._id)")
      .dl_md_8.dl_vertical
        input.dl_modal_input.dl-form-control(type="text" ng-model="private_message_content.text" placeholder="请控制在140字以内" maxlength=140 required)
      .dl_md_1.dl_vertical
        button.dl_btn.dl_btn_right(ng-click="sendToAll()" ng-disabled="message_form.$invalid || (multi_send && dOt_select_num == 0)") 发送
  .dl_row(ng-if="dOts.length > 0")
    .dl_message_slide
      .dl_message_item(ng-repeat="dOt in dOts")
        input.dl_checkbox(type="checkbox" ng-model="dOt.selected" value="true" ng-change="selectReady($index)")
        span(title="{{dOt.name}}") {{dOt.name}}
  .dl_modal_container.margin_top_50
    .dl_row.send_caption
      span.send_text 已发送列表
    .dl_row.message_panel(ng-repeat="send_message in send_messages" ng-if="$index >= page_send.up && $index <= page_send.down")
      .row.line_left
        .dl_message_body
          .dl_row(ng-switch="send_message.message_type")
              p.subtitle(ng-switch-when="3")
                发往全公司
              p.subtitle(ng-switch-when="1")
                发往活动 {{send_message.campaign_name}}
                if provider === 'user'
                  span(ng-if="send_message.sender.role=='HR'") (来自
                    a(href="/company/home/{{send_message.sender._id}}") {{send_message.sender.nickname}}
                    span )
                else
                  span(ng-if="send_message.sender.role=='LEADER'") (来自
                    a(href="/users/home/{{send_message.sender._id}}") {{send_message.sender.nickname}}
                    span )
              p.subtitle(ng-switch-when="2")
                发往比赛 {{send_message.campaign_name}}
                if provider === 'user'
                  span(ng-if="send_message.sender.role=='HR'") (来自
                    a(href="/company/home/{{send_message.sender._id}}") {{send_message.sender.nickname}}
                    span )
                else
                  span(ng-if="send_message.sender.role=='LEADER'") (来自
                    a(href="/users/home/{{send_message.sender._id}}") {{send_message.sender.nickname}}
                    span )
              p.subtitle(ng-switch-when="0")
                发往 {{send_message.team.name}}
                if provider === 'user'
                  span(ng-if="send_message.sender.role=='HR'") (来自
                    a(href="/company/home/{{send_message.sender._id}}") {{send_message.sender.nickname}}
                    span )
                else
                  span(ng-if="send_message.sender.role=='LEADER'") (来自
                    a(href="/users/home/{{send_message.sender._id}}") {{send_message.sender.nickname}}
                    span )
              span {{send_message.detail}}
        .dl_message_tail
          .dl_message_date
            span {{send_message.date | date:'yyyy-MM-dd HH:mm'}}
          a.pull-right(ng-click="setToDelete($index)") 删除
    .dl_row.dl_center(ng-if="send_messages.length > 10")
      button.dl_btn.dl_btn_small(ng-disabled="page_send.arrow == 'right' || page_send.arrow == 'none' " ng-click="pageOperate('left')") <<
      button.dl_btn.dl_btn_small(ng-disabled="page_send.arrow == 'left' || page_send.arrow == 'none' " ng-click="pageOperate('right')") >>
    .dl_row
      button.dl_btn.dl_btn_small.margin_left_5(ng-click="deleteAll()" ng-if="send_messages.length > 0") 全部删除