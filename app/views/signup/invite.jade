extends ../layouts/register

block contentExt
  .dl_container.clearfix
    .signup_row
      .block.block_left.notification_block
        .signup_title.personal_title
          span 个人注册
        .signup_tips
          p 我们会严格审核您的申请,
          p 确保每个用户的身份都真实可靠
      .block.personal_signup.signup_block(ng-controller='ActiveController' ng-init="currentDomain='#{domains[0]}';")
        if invitedUser
          .hidden#invitedUserData(data-id="#{invitedUser.id}" data-email="#{invitedUser.email}" data-active="#{invitedUser.mail_active}")
        form.form-inline.form-horizontal(role="form" name='active_form' action='/users/dealActive' method='post')
          .form-group.dl_sm_group(ng-class="{'has-error':active&&active!==1}")
            if invitedUser
              .dl_row
                .label_left
                  label.control-label ＊企业邮箱:
                .input_right
                  input.dl-form-control(type="text" value="{{email}}" disabled)
              input(type="hidden" name="email" value="#{invitedUser.email}")
              input(type="hidden" name="inviteKey" value="#{inviteKey}")
            else
              .dl_row
                .label_left
                  label.control-label(for="email") ＊企业邮箱:
                .input_right
                  .input_email
                    label.sr-only Email Host
                    input.dl-form-control(type="text" name="host" ng-model="email" placeholder="email" ng-blur="mailCheck()" required)
                  span.at @
                  .select_domain
                    label.sr-only Email Domain
                    if domains.length === 1
                      input(type="hidden" name="domain" ng-model="currentDomain" value="#{domains[0]}")
                      input.dl-form-control(type="text" value="#{domains[0]}" disabled="true")
                    if domains.length > 1
                      select.dl-form-control(name="domain" ng-model="currentDomain" ng-change="mailCheck()")
                        each domain in domains
                          option(value="#{domain}" selected='selected')= domain
                    input(type="text" name="index" ng-model="active" ng-show='false')
            .dl_row.email_tip(ng-show="(active||loading)&&active!==4" ng-cloak)
              p
              img(ng-show='loading' src='/img/loading.gif')
              div(ng-show='active==1' ng-cloak)
                span 此邮箱未被注册!
              div(ng-show='active==2' ng-cloak)
                p 您的邮箱已注册过,请查收邮件,若未收到请点击重发按钮再次发送。
                p 
                  span 若之前不是本人操作请
                  a.subtitle(ng-click="active=4") 再次填写信息
                  span 并查看邮箱激活。
              div(ng-show='active==3' ng-cloak)
                span 您的邮箱已注册,请
                a(href='/users/signin') 登录。
                span 若是您忘记了密码,
                a(href='/users/forgetPwd') 请点此跳转
              p
          include partials/personal_form
block footExt
  script(src="/js/controllers/user.js")
  script.
    window.location.hash='';
    var $buoop = {vs:{i:10,f:15,o:12.1,s:5.1}}; 
    $buoop.ol = window.onload; 
    window.onload=function(){ 
      try {if ($buoop.ol) {$buoop.ol();} }catch (e) {} 
      var e = document.createElement("script"); 
      e.setAttribute("type", "text/javascript"); 
      e.setAttribute("src", "/js/notice/update.js"); 
      document.body.appendChild(e);
    } 