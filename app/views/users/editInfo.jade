.loading_div(ng-show = 'loading')
div.use_edit_info(ng-show = '!loading')
  form.form-horizontal(name="accountForm")
    .dl_row
      h5.pull-left #{__("INFO")}
      button.dl_btn.dl_btn_small.pull-right(ng-if="role!='PARTNER'" ng-click="baseEditToggle()" ng-bind="baseButtonStatus" ng-disabled="accountForm.$invalid&&!baseUnEdit")
    hr.margin_top_6
    .dl_row.clearfix
      .aside
        img.img-responsive.size_128.img-thumbnail(ng-src="{{user.photo ? user.photo :'/img/icons/default_user_photo.png'}}")
      .dl_row.margin_top_15(ng-if="role!='PARTNER'")
        a.clearLinkUnderline.dl_btn.dl_btn_medium(href="/users/editPhoto/#{global_user._id}") #{__("CHANGE")}#{__("AVATAR")}
      .dl_row.margin_top_15(ng-if="role!='PARTNER'")
        a(href="#/changePassword/#{global_user._id}")
          button.dl_btn.dl_btn_medium #{__("CHANGE")}#{__("PASSWORD")}
    .dl_row.clearfix(ng-if="user.nickname !=undefined || !baseUnEdit")
      .info_side
        span.info_label #{__("NICKNAME")}
      .info_detail
        input.dl_input.dl_form-Control.editToggle(type="text" name ="nickname" ng-model="user.nickname" ng-maxlength=20 tooltip="{{accountForm.nickname.$invalid? '昵称最长字数20字':''}}" ng-disabled="baseUnEdit" tooltip-placement="right" required ng-cloak)
    .dl_row.clearfix(ng-if="user.realname !=undefined || !baseUnEdit")
      .info_side
        span.info_label #{__("REALNAME")}
      .info_detail
        input.dl_input.dl_form-Control.editToggle(type="text" name ="realname" ng-model="user.realname" ng-maxlength=20 tooltip="{{accountForm.realname.$invalid? '真实姓名最长20字':''}}" ng-disabled="baseUnEdit" tooltip-placement="right" ng-cloak)
    .dl_row.clearfix
      .info_side
        span.info_label #{__("COMPANY")}
      .info_side
        span.info_label(ng-cloak) {{user.cname}}
    .dl_row.clearfix
      .info_side
        span.info_label 部门
      .info_detail(ng-if="!baseUnEdit")
        .tree.select_tree
          ul
            li(ng-include="'node.html'" ng-class="hasChild(node)")
      .info_detail_2(ng-if="baseUnEdit")
        span.info_label {{ user.department.name }}
    .dl_row.clearfix(ng-if="user.sex !=undefined || ! baseUnEdit")
      .info_side
        span.info_label #{__("GENDER")}
      .info_detail_2(ng-if="baseUnEdit")
        span.info_label {{user.sex}}
      .info_detail(ng-if="role!='PARTNER' && !baseUnEdit")
        span.radio.info_radio.info_label
          input(type="radio" name="sex" value="男" ng-model="user.sex" ng-disabled="baseUnEdit")
          | #{__("MALE")}
        span.radio.info_radio.info_label
          input(type="radio" name="sex" value="女" ng-model="user.sex" ng-disabled="baseUnEdit")
          | #{__("FEMALE")}
    .dl_row.clearfix(ng-if="user.introduce || ! baseUnEdit")
      .info_side
        span.info_label #{__("BRIEF")}
      .info_detail
        textarea.dl_input.dl_form-Control.editToggle(rows="3" cols="40" name="introduce" ng-model="user.introduce" ng-maxlength=70 tooltip="{{accountForm.introduce.$invalid? '个人简介最长40字':''}}" ng-disabled="baseUnEdit" tooltip-placement="right" ng-cloak)
    .dl_row.clearfix
      .info_side
        span.info_label #{__("REGISTER_DATE")}
      .info_side
        span.info_label {{user.register_date | date:'yyyy-MM-dd HH:mm:ss'}}
  form.form-horizontal(name="linkForm")
    .dl_row
      h5.pull-left #{__("CONTACT")}
      button.dl_btn.dl_btn_small.pull-right(ng-if="role!='PARTNER'" ng-click="linkEditToggle()" ng-bind="linkButtonStatus" ng-disabled="linkForm.$invalid")
    hr.margin_top_6
    .dl_row.clearfix(ng-if="user.phone !=undefined || !linkUnEdit")
      .info_side
        span.info_label #{__("PHONE")}
      .info_detail
        input.dl_input.dl_form-Control.editToggle(type="text" name="phone" ng-model="user.phone" ng-disabled="linkUnEdit" ng-maxlength=20)
    .dl_row.clearfix(ng-if="user.email !=undefined || !linkUnEdit")
      .info_side
        span.info_label #{__("EMAIL")}
      .info_detail
        input.dl_input.dl_form-Control.editToggle(type="email" name="email" ng-model="user.email" ng-disabled="true")
    .dl_row.clearfix(ng-if="user.qq !=undefined || !linkUnEdit")
      .info_side
        span.info_label #{__("QQ")}
      .info_detail
        input.dl_input.dl_form-Control.editToggle(type="text" name="qq" ng-model="user.qq" ng-disabled="linkUnEdit" ng-maxlength=20)
  script.
    $(function() {
      $('#birthday').datetimepicker({
        autoclose: true,
        endDate: new Date(),
        minView: 2,
        format: 'yyyy-mm-dd'
      });
    });

  script(type="text/ng-template" id="node.html")
    .self.inline
      span(ng-click="selectNode(node)" ng-class="{'selected': node.selected}")
        .inline &nbsp;{{node.name}}
    ul(ng-if="!node.hideChild")
      li(ng-repeat="node in node.department" ng-include="'node.html'" ng-class="hasChild(node)")
