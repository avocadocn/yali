extend ../layouts/user_base

block contentExt
  .dl_container.photo_album(ng-controller="PhotoDetailCtrl" ng-init="photo_id='#{photo_detail._id}'")
    include ../partials/breadcrumb
    +breadcrumb(links)
    input#return_url(type="hidden" value="#{return_url}")
    hr
    .row.photo_detail_container
      .col-xs-8.col-sm-8
        .relative
          if photo_detail.pre_id
            a.left(href="/photoAlbum/#{photo_album._id}/photoView/#{photo_detail.pre_id}") 上一张
          p.text-center: strong= photo_detail.name
          if photo_detail.next_id
            a.right(href="/photoAlbum/#{photo_album._id}/photoView/#{photo_detail.next_id}") 下一张
        div
          img.photo_ori.img-responsive.center-block(src="#{photo_detail.uri}")
        p.text.margin_top_5
          each tag in photo_detail.tags
            span.tag= tag
      .col-xs-offset-1.col-sm-offset-1.col-xs-3.col-sm-3
        .media
          .pull-left
            img.media-object.header_logo.img-thumbnail(src="#{photo_album.owner.logo}")
          .media-body
            h4= photo_album.owner.name
        p.text 相册名:&nbsp;#{photo_album.name}
        p.text 照片数:&nbsp;#{photo_album.photo_count}
        p.text 最后更新:&nbsp;#{moment(photo_album.update_date).format('YYYY.MM.DD')}
        if editAuth === true
          form.photo_operator_form.js_ajax_form(action="/photoAlbum/#{photo_album._id}/photo/#{photo_detail._id}" method="post")
            input(type="hidden" name="_method" value="put")
            h4 给照片添加标签
            p.text 输入照片中人名/队名/企业名/
            input.form-control.edit_photo_input(type="text" name="tags" required)
            button.dl_btn.dl_btn_small(type="submit") 添加标签
          form.photo_operator_form.js_ajax_form(action="/photoAlbum/#{photo_album._id}/photo/#{photo_detail._id}" method="post")
            input(type="hidden" name="_method" value="put")
            input.form-control.edit_photo_input(type="text" name="name" value="#{photo_detail.name}" required)
            button.dl_btn.dl_btn_small(type="submit") 更改照片名字
          form#delete_form.photo_operator_form.js_ajax_form(action="/photoAlbum/#{photo_album._id}/photo/#{photo_detail._id}" method="post")
            input(type="hidden" name="_method" value="delete")
            button#delete_button.dl_btn.dl_btn_small.dl_btn_danger(type="button") 删除该照片
append footExt
  script(src="/js/controllers/photo_detail.js")
