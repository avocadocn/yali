<ion-view title="日程列表">
  <ion-nav-buttons side="left">
    <button menu-toggle="left" class="button button-icon icon ion-navicon"></button>
  </ion-nav-buttons>
  <ion-content class="has-header">

    <div class="calendar">
      <nav>
        <div class="operator clearfix">
          <div class="pull-left">
            <div class="btn" ng-if="view==='month'" ng-click="back()"><i class="icon ion-chevron-left"></i>&nbsp;{{ current_year }}</div>
            <div class="btn" ng-if="view==='day'" ng-click="back()"><i class="icon ion-chevron-left"></i>&nbsp;{{ current_month }}</div>
          </div>
          <div class="pull-right" ng-if="view!=='year'">
            <div class="btn" ng-click="pre()"><i class="icon ion-chevron-left"></i></div>
            <div class="btn today" ng-click="today()">今天</div>
            <div class="btn" ng-click="next()"><i class="icon ion-chevron-right"></i></div>
          </div>
        </div>
        <div class="week text-center clearfix" ng-if="view!=='year'">
          <div class="day weekend">日</div>
          <div class="day">一</div>
          <div class="day">二</div>
          <div class="day">三</div>
          <div class="day">四</div>
          <div class="day">五</div>
          <div class="day weekend">六</div>
        </div>
        <div class="date_list text-center clearfix" ng-if="view==='day'">
          <div class="date_box" ng-repeat="date in current_week_date">
            <div class="date" ng-class="{today: date.is_today===true, current_day: date.is_current===true}" ng-click="updateDay(date)">{{ date.getDate() }}</div>
          </div>
        </div>
        <div class="date_bar text-center" ng-if="view==='day'">{{ current_day.format_date }}&nbsp;{{ current_day.format_day }}</div>
      </nav>
      <div class="calendar_box" ng-class="{full_box: view==='year'}">
        <div class="calendar_year clearfix" ng-if="view==='year'">
          <div class="year_section" ng-repeat="month in year" ng-click="monthView($index)">
            <div class="table_wrap">
              <div class="table_cell">
                <div class="year_box">{{ month }}</div>
              </div>
            </div>
          </div>
        </div>
        <div class="calendar_month clearfix" ng-if="view==='month'">
          <div class="month" ng-class="current_month_offset">{{ current_month }}</div>
          <div class="calendar_day text-center" ng-repeat="day in month" ng-class="day.first_day">
            <div class="calendar_date" ng-class="{weekend: day.is_weekend===true, today: day.is_today===true}" ng-click="updateDay(day.full_date)">{{ day.date }}</div>
            <div class="event_unjoin" ng-if="day.has_event && !day.has_joined_event"></div>
            <div class="event_joined" ng-if="day.has_joined_event"></div>
          </div>
        </div>
        <div class="calendar_day clearfix" ng-if="view==='day'">
          <a class="calendar_campaign clearfix" ng-repeat="campaign in current_day.campaigns" ng-href="#/app/campaign_detail/{{ campaign._id }}" ng-click="saveStatus()">
            <div class="logo"><img ng-src="{{ campaign.logo }}"/></div>
            <div class="calendar_content">
              <div class="text">{{ campaign.theme }}</div>
              <div class="text time">开始: {{ campaign.format_start_time }}</div>
              <div class="text time">结束: {{ campaign.format_end_time }}</div>
              <div class="joined_flag" ng-if="campaign.is_joined">已参加</div>
            </div>
          </a>
          <div class="text-center" ng-if="current_day.campaigns.length === 0">今天没有活动哦</div>
        </div>
      </div>
    </div>
  </ion-content>
</ion-view>
